{"version":3,"sources":["webpack:///./src/views/login/index.vue?ba30","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?e0c5","webpack:///./src/views/login/index.vue","webpack:///./src/views/login/index.vue?4dfe","webpack:///./src/api/user.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","ref","model","value","user","callback","$$v","$set","expression","slot","staticStyle","on","$event","countDownControl","changeCountDown","_v","login","staticRenderFns","name","data","mobile","code","methods","component","request","method","url","getCodes","getUserInfo","getUserInfoById","Id","followUser","target","unFollowUser","getUserProfile","changeUserPhoto","changeUserProfile"],"mappings":"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","file":"js/chunk-381a7443.0ff77878.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('van-nav-bar',{attrs:{\"title\":\"登录\"}}),_c('ValidationObserver',{ref:\"myform\"},[_c('ValidationProvider',{attrs:{\"name\":\"手机号\",\"rules\":\"required|mobile\",\"immediate\":\"\"}},[_c('van-field',{attrs:{\"placeholder\":\"请输入手机号\"},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}},[_c('i',{staticClass:\"icon icon-Mobile-\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})])],1),_c('ValidationProvider',{attrs:{\"name\":\"验证码\",\"rules\":\"required|code\",\"immediate\":\"\"}},[_c('van-field',{attrs:{\"placeholder\":\"请输入验证码\"},model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[_c('i',{staticClass:\"icon icon-icon--\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"}),_c('div',{attrs:{\"slot\":\"button\"},slot:\"button\"},[(_vm.countDownControl)?_c('van-count-down',{staticStyle:{\"height\":\"30px\"},attrs:{\"time\":1000*60,\"format\":\"ss 秒\"},on:{\"finish\":function($event){_vm.countDownControl=false}}}):_c('van-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.changeCountDown}},[_vm._v(\"发送验证码\")])],1)])],1)],1),_c('div',{staticClass:\"loginButton\"},[_c('van-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")])],1),_c('p',{staticClass:\"bottomText\"},[_vm._v(\"隐私条款\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"login\">\n    <van-nav-bar title=\"登录\"></van-nav-bar>\n  <ValidationObserver ref=\"myform\">\n    <ValidationProvider name='手机号' rules='required|mobile' immediate>\n      <van-field placeholder=\"请输入手机号\" v-model=\"user.mobile\">\n        <i slot=\"left-icon\" class=\"icon icon-Mobile-\"></i>\n      </van-field>\n        <!-- <p>{{errors[0]}}</p> -->\n    </ValidationProvider>\n\n    <ValidationProvider name='验证码' rules='required|code'  immediate>\n      <van-field placeholder=\"请输入验证码\" v-model=\"user.code\">\n        <i slot=\"left-icon\" class=\"icon icon-icon--\"></i>\n        <div slot=\"button\">\n          <van-count-down\n            v-if=\"countDownControl\"\n            :time=\"1000*60\"\n            format=\"ss 秒\"\n            @finish=\"countDownControl=false\"\n            style=\"height:30px\"\n          />\n          <van-button v-else size=\"small\" type=\"primary\" @click=\"changeCountDown\">发送验证码</van-button>\n        </div>\n      </van-field>\n    </ValidationProvider>\n  </ValidationObserver>\n    <div class=\"loginButton\">\n      <van-button type=\"info\" @click=\"login\">登录</van-button>\n    </div>\n    <p class=\"bottomText\">隐私条款</p>\n  </div>\n</template>\n\n<script>\n// import request from '@/utils/request.js'\nimport { login as onLogin, getCodes } from '@/api/user.js' // 引入用户相关接口\nimport { validate } from 'vee-validate'\nexport default {\n  name: 'login',\n  data () {\n    return {\n      countDownControl: false,\n      user: {\n        mobile: '',\n        code: ''\n      }\n    }\n  },\n  methods: {\n    async changeCountDown () {\n      try {\n        const validateResult = await validate(this.user.mobile, 'required|mobile', { name: '手机号' })\n        // console.log(validateResult)\n        if (!validateResult.valid) {\n          this.$toast(validateResult.errors[0])\n          return\n        }\n        // 表单验证成功，执行发送验证码请求\n        let result = await getCodes(this.user)\n        this.$toast('发送成功，请注意查收！')\n        console.log(result)\n        this.countDownControl = true\n      } catch (error) {\n        console.log(error)\n        if (error.response.status === 429) {\n          this.$toast('请勿频繁发送！')\n          return\n        }\n        this.$toast('发送失败！')\n      }\n    },\n    // 用户登录请求\n    async login () {\n      const success = await this.$refs.myform.validate()\n      if (!success) {\n        const errors = this.$refs.myform.errors\n        for (let key in errors) {\n          const item = errors[key]\n          if (item[0]) {\n            this.$toast(item[0])\n            return\n          }\n        }\n        return\n      }\n      // 加载loading\n      this.$toast.loading({\n        message: '加载中...',\n        forbidClick: true\n      })\n      try {\n        let result = await onLogin(this.user)\n        // console.log(result.data.data)\n        this.$store.commit('setUser', result.data.data)\n        this.$toast.success('登陆成功嘞')\n        this.$router.push('/my')\n      } catch (error) {\n        console.log(error)\n        this.$toast.fail('登陆失败')\n      }\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n.loginButton {\n  padding: 27px 16px;\n  button {\n    width: 100%;\n    background-color: #6db4fb;\n  }\n}\n.bottomText {\n  font-size: 12px;\n  color: #ccc;\n  width: 100%;\n  text-align: center;\n  position: absolute;\n  bottom: 0;\n}\n.icon {\n  font-size: 18px;\n}\n.van-field {\n  align-items: center;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=859007f0&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=859007f0&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"859007f0\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=859007f0&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=859007f0&lang=less&scoped=true&\"","// 用户相关的接口，一致保存维护\nimport request from '@/utils/request.js'\n// 登录验证\nexport const login = data => {\n  return request({\n    method: 'post',\n    url: '/app/v1_0/authorizations',\n    data\n  })\n}\n// 发送验证码\nexport const getCodes = data => {\n  return request({\n    method: 'get',\n    url: `/app/v1_0/sms/codes/${data.mobile}`\n  })\n}\n\n// 获取用户自己信息\nexport const getUserInfo = () => {\n  return request({\n    method: 'get',\n    url: '/app/v1_0/user'\n  })\n}\n\n// 获取当前用户信息\nexport const getUserInfoById = Id => {\n  return request({\n    method: 'get',\n    url: `/app/v1_0/users/${Id}`\n  })\n}\n\n// 关注用户\nexport const followUser = target => {\n  return request({\n    url: '/app/v1_0/user/followings',\n    method: 'post',\n    data: {\n      target\n    }\n  })\n}\n\n// 取消关注用户\nexport const unFollowUser = target => {\n  return request({\n    url: `/app/v1_0/user/followings/${target}`,\n    method: 'delete'\n  })\n}\n\n// 获取用户个人资料\nexport const getUserProfile = () => {\n  return request({\n    method: 'get',\n    url: '/app/v1_0/user/profile'\n  })\n}\n\n// 编辑用户头像\nexport const changeUserPhoto = data => {\n  return request({\n    method: 'patch',\n    url: '/app/v1_0/user/photo',\n    data\n  })\n}\n\n// 编辑用户个人资料\nexport const changeUserProfile = data => {\n  return request({\n    method: 'patch',\n    url: '/app/v1_0/user/profile',\n    data\n  })\n}\n"],"sourceRoot":""}